<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>Angus Tan | Projects</title>

  <link rel="icon" href="/assets/images/AutumnLeaf.gif" />
  <link href="/css/base.css" type="text/css" rel="stylesheet" />
  <link href="./index.css" type="text/css" rel="stylesheet" />
</head>


<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VPFYQJ4C7S"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'G-VPFYQJ4C7S');
</script>

<body>
  <scroll-top-button class="scroll-top-button"></scroll-top-button>
  <header-custom title="ANGUS"></header-custom>

  <div class="filler"></div>

  <!-- <div class="empty">
    <h2>WIP</h2>
    <p>projects</p>
  </div> -->

  <canvas id="infinte-gallery"></canvas>
  
  <!-- Project Info Panel -->
  <div id="project-info-panel" class="project-info-panel">
    <div class="project-info-content">
      <h5 id="project-title" class="project-title"></h5>
      <div class="project-meta">
        <p id="project-year"></p>
        <p>-</p>
        <p id="project-type"></p>
      </div>
    </div>
  </div>

  <!-- Gallery Navigation Counter -->
  <div class="gallery-navigation">
    <div class="circular-progress">
      <svg width="60" height="60" viewBox="0 0 60 60">
        <circle cx="30" cy="30" r="25" fill="none" stroke="rgba(0,0,0,0.1)" stroke-width="2"/>
        <circle id="progress-circle" cx="30" cy="30" r="25" fill="none" stroke="var(--primary-color, #E3955D)" 
                stroke-width="2" stroke-dasharray="157" stroke-dashoffset="157" class="progress-circle"/>
      </svg>
    </div>
    <p>Drag to browse</p>
  </div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/OrbitControls.js"></script>
  
  <div class="project-footer">
    <footer-custom></footer-custom>
  </div>
</body>

<script type="module">
  import "/components/header/index.js";
  import "/components/footer/index.js";
  import globalContext from "/datas/globalContext.js";
  import {
    elementIsInViewPort,
    debounce,
  } from "/js/IntersectionObserver/vi.js";
  import "/components/button/ScrollTopButton/index.js"

  import "/js/ThreeJS/infiniteGallery.js"

  const filler = document.querySelector(".filler");
  const footer = document.querySelector("footer-custom");

  setHeaderHeight();

  window.addEventListener("scroll", debounce(checkItemInView, 5));

  // function setHeaderHeight(height) {
  //   filler.style.height = `${height}px`;
  // }

  function setHeaderHeight(height) {
    if (window.innerWidth > 319 && window.innerWidth < 768) {
      filler.style.height = '70px'
    } else {
      filler.style.height = '250px'
    }
  }

  function checkItemInView() {
    // Check footer
    if (elementIsInViewPort(footer, 5)) {
      footer.shadowRoot
        .querySelector(".footer")
        .classList.add("outer-container-show");
    }

    // Check first hori(then stick the screen to top)
    // if(elementIsInViewPort(firstHori, 50)){
    //   console.log("First hori in view")
    //   firstHori.scrollIntoView({behavior: 'smooth'})

    // }
  }

</script>

</html>